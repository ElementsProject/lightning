{
  "$schema": "../rpc-schema-draft.json",
  "type": "object",
  "rpc": "withdraw",
  "title": "Command for withdrawing funds from the internal wallet",
  "description": [
    "The **withdraw** RPC command sends funds from Core Lightning's internal wallet to the address specified in *destination*."
  ],
  "request": {
    "required": [
      "destination",
      "satoshi"
    ],
    "additionalProperties": false,
    "properties": {
      "destination": {
        "type": "string",
        "description": [
          "Any Bitcoin accepted type, including bech32."
        ]
      },
      "satoshi": {
        "type": "sat_or_all",
        "description": [
          "The amount to be withdrawn from the internal wallet (expressed, as name suggests, in satoshi). The string *all* can be used to specify withdrawal of all available funds (possibly restricted by the `utxos` parameter, and note that if we have any anchor channels, this will always leave at least `min-emergency-msat` as change).  Otherwise, it is in satoshi precision; it can be a whole number, a whole number ending in *sat*, a whole number ending in *000msat*, or a number with 1 to 8 decimal places ending in *btc*."
        ]
      },
      "feerate": {
        "type": "feerate",
        "description": [
          "Used for the withdrawal as initial feerate."
        ],
        "default": "*normal*"
      },
      "minconf": {
        "type": "u16",
        "description": [
          "Minimum number of confirmations that used outputs should have."
        ],
        "default": 1
      },
      "utxos": {
        "type": "array",
        "description": [
          "Specifies the utxos to be used to be withdrawn from, as an array of `txid:vout`. These must be drawn from the node's available UTXO set."
        ],
        "items": {
          "type": "outpoint"
        }
      }
    }
  },
  "response": {
    "required": [
      "psbt",
      "tx",
      "txid"
    ],
    "additionalProperties": false,
    "properties": {
      "tx": {
        "type": "hex",
        "description": [
          "The fully signed bitcoin transaction."
        ]
      },
      "txid": {
        "type": "txid",
        "description": [
          "The transaction id of *tx*."
        ]
      },
      "psbt": {
        "type": "string",
        "description": [
          "The PSBT representing the unsigned transaction."
        ]
      }
    }
  },
  "errors": [
    "On failure, an error is reported and the withdrawal transaction is not created.",
    "",
    "- -1: Catchall nonspecific error.",
    "- 301: There are not enough funds in the internal wallet (including fees) to create the transaction.",
    "- 302: The dust limit is not met.",
    "- 313: The `min-emergency-msat` reserve not be preserved (and we have anchor channels)."
  ],
  "author": [
    "Felix <<fixone@gmail.com>> is mainly responsible."
  ],
  "see_also": [
    "lightning-listfunds(7)",
    "lightning-fundchannel(7)",
    "lightning-newaddr(7)",
    "lightning-txprepare(7)",
    "lightning-feerates(7)"
  ],
  "resources": [
    "Main web site: <https://github.com/ElementsProject/lightning>"
  ],
  "examples": [
    {
      "request": {
        "id": "example:withdraw#1",
        "method": "withdraw",
        "params": {
          "destination": "bcrt1qwx6am26cuw38y4863pd6swrce2g8mzhaxr9xp8",
          "satoshi": 555555
        }
      },
      "response": {
        "tx": "020000000169baded91234f208471fe0b7efd048560a4ec2aca6ac1df00ae4729a6c368a140000000000fdffffff02237a08000000000016001471b5ddab58e3a27254fa885ba83878ca907d8afd7ecc1500000000002251202b5dd0613b6e534f572dbcf4311b66e6cc8bb07e285928ddb6fa5791e473787484000000",
        "txid": "797a6c54b6cfb99ab3b6453fca66d9c077af09f7be4a951cb0f2e3c0cd63ee90",
        "psbt": "cHNidP8BAgQCAAAAAQMEhAAAAAEEAQEBBQECAQYBAwH7BAIAAAAAAQCyAgAAAAJVMQxiObHGkc2owFTzkzRn+3UVPd29g9q+xdYhmQ3ckgAAAAAA/f///6czBVHqH7LMLWzkkTkfaDAii0v18qYWqwo3IAICfpPtAQAAAAD9////AkVXHgAAAAAAIlEg/at8AfrnDAjgsfmsrMoRClMSHnXcVKJedUJBbzQq6vdAQg8AAAAAACIAIJZV4qczDNhtxp+O0YRa9VgN0GsVp5QDTJVx5T1WObOXewAAAAEBK0VXHgAAAAAAIlEg/at8AfrnDAjgsfmsrMoRClMSHnXcVKJedUJBbzQq6vcBDiBput7ZEjTyCEcf4Lfv0EhWCk7CrKasHfAK5HKabDaKFAEPBAAAAAABEAT9////ARNAHO2bgSAdOnELjVnpbsTz7m7rgxRnyUQ9cRVtMF7bR2ZbWWuexz11UjfIoiQsBhK3rp+KkxJLGo8xXnRN0hK72iEWvZI/zJ5gMwIKRWhwvhoONSpzuE+hMin+5LvMB/uiSToJAMrfGCgAAAAAACICA6Jvzf+c2c5Qrvvj78smeIzuWAjjEtHW01YDo2je0daMCHG13asNAAAAAQMII3oIAAAAAAABBBYAFHG13atY46JyVPqIW6g4eMqQfYr9DPwJbGlnaHRuaW5nBAIAAQABAwh+zBUAAAAAAAEEIlEgK13QYTtuU09XLbz0MRtm5syLsH4oWSjdtvpXkeRzeHQhB/ezBtxauw6UTQFvjhaT8ztqh+dAYi+W2/WHIEQ/e965CQBPad/3DwAAAAA="
      }
    },
    {
      "request": {
        "id": "example:withdraw#2",
        "method": "withdraw",
        "params": {
          "destination": "bcrt1p2gppccw6ywewmg74qqxxmqfdpjds3rpr0mf22y9tm9xcc0muggwsea9nkf",
          "satoshi": "all",
          "feerate": "20000perkb",
          "minconf": 0,
          "utxos": [
            "7cce7550c4b37924bb74fd4baf8f1946a4b14c050c42f2479b04fede08652aa9:1"
          ]
        }
      },
      "response": {
        "tx": "0200000001a92a6508defe049b47f2420c054cb1a446198faf4bfd74bb2479b3c45075ce7c0100000000fdffffff01d563dc0b0000000022512052021c61da23b2eda3d5000c6d812d0c9b088c237ed2a510abd94d8c3f7c421d88000000",
        "txid": "6430642958a9aaa5c380bb9ea5048ae920557df4e8c8f959ee745f87f03662ed",
        "psbt": "cHNidP8BAgQCAAAAAQMEiAAAAAEEAQEBBQEBAQYBAwH7BAIAAAAAAQCJAgAAAAGz2CDBGuOklbgHzcv1kfmjgjUfUOYes93LsMOptm8SiQEAAAAA/f///wJAQg8AAAAAACIAIIaYZYoB77AB4cxN9qi28620Yfo+Z5OF/arkAL1zmWsygWzcCwAAAAAiUSCKc7soFDPytdtUYcZ3iqKv0o4BHea9BHmaWZFmLGHXqDMAAAABASuBbNwLAAAAACJRIIpzuygUM/K121RhxneKoq/SjgEd5r0EeZpZkWYsYdeoAQ4gqSplCN7+BJtH8kIMBUyxpEYZj69L/XS7JHmzxFB1znwBDwQBAAAAARAE/f///wETQGrLBJ5XFyUx9B4SItbcP7L5MdB2XyQHymoi/1innyYnSSmUVvkqQYn/wckxggReFS6+BydfZ2/aB/1TRMJyl70hFi55mhYqTXiAV2eIrXh1Nrfu0+eScntk4eo0QWenuG5SCQC6dkxmAAAAAAABAwjVY9wLAAAAAAEEIlEgUgIcYdojsu2j1QAMbYEtDJsIjCN+0qUQq9lNjD98Qh0hB8SkNSQBiTs1cYIq8kWiODRmmFlnt+VkoODlBh1PjXFxCQCLx6pcDgAAAAz8CWxpZ2h0bmluZwQCAAEA"
      }
    }
  ]
}
