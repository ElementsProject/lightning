'\" t
.\"     Title: lightning-waitnewpaycode
.\"    Author: [see the "AUTHOR" section]
.\" Generator: DocBook XSL Stylesheets v1.79.1 <http://docbook.sf.net/>
.\"      Date: 06/28/2019
.\"    Manual: \ \&
.\"    Source: \ \&
.\"  Language: English
.\"
.TH "LIGHTNING\-WAITNEWPA" "7" "06/28/2019" "\ \&" "\ \&"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
lightning-waitnewpaycode \- Command for waiting for payments, intended for self\-payments\&.
.SH "SYNOPSIS"
.sp
\fBwaitnewpaycode\fR \fIpreimage\fR [\fImin_msatoshi\fR] [\fImax_msatoshi\fR] [\fIexpiry\fR]
.SH "DESCRIPTION"
.sp
The \fBwaitnewpaycode\fR RPC command waits until an incoming payment arrives which matches the given \fIpreimage\fR\&.
.sp
This is usually used by plugins that need to receive funds without triggering the \fBwaitanyinvoice\fR command\&. Existing client software may be waiting for invoices they have issued, and may get confused if they receive notification for an unknown invoice\&. The \fBwaitanypaycode\fR command allows a node to be paid without triggering clients using invoices\&.
.sp
The \fIpreimage\fR must be 32 random bytes in a hexadecimal string (64 hexadecimal digits)\&. \fBIMPORTANT\fR: you are responsible, to ensure appropriate care for generating using a secure pseudorandom generator seeded with sufficient entropy, and keeping the preimage secret\&.
.sp
If neither \fImin_msatoshi\fR nor \fImax_msatoshi\fR are specified, then any incoming amount will be accepted\&. If one is specified but not the other, only that specific amount will be accepted\&. Otherwise, the incoming amount must be between \fImin_msatoshi\fR and \fImax_msatoshi\fR inclusive\&. If an incoming payment arrives that fails this amount validation, the payment will be rejected and \fBwaitnewpaycode\fR continues waiting for incoming payment\&.
.sp
The wait will end after \fIexpiry\fR seconds if not paid\&. The daemon will forget about the paycode after either expiration or payment\&.
.SH "RETURN VALUE"
.sp
On success, an object with a field \fIstatus\fR will be returned\&. The \fIstatus\fR field will be either the string "paid" or "expired"\&.
.sp
On failure, the error code 901 may be returned indicating that the preimage already exists as an invoice or another paycode\&.
.SH "AUTHOR"
.sp
ZmnSCPxj <ZmnSCPxj@protonmail\&.com> is mainly responsible\&.
.SH "SEE ALSO"
.sp
lightning\-invoice(7)\&.
.SH "RESOURCES"
.sp
Main web site: https://github\&.com/ElementsProject/lightning
